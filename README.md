Slack Modal & Interaction Codegen for Go
This tool is a command-line code generator that automates the creation of Go structs and a dispatcher for handling Slack Block Kit modal submissions and block actions. It reads Slack's JSON modal definitions and produces type-safe Go code, significantly simplifying the backend logic required to process Slack interactions.

Features
Struct Generation: Automatically creates Go structs from your modal's input blocks. Each field is named based on the action_id and correctly tagged for JSON unmarshaling.

Dispatcher Generation: Generates a central Dispatcher to route both view_submission and block_actions payloads to the correct, strongly-typed handlers.

Type-Safe Handlers: Generates handler interfaces for each modal and for block actions, ensuring that your business logic receives a pre-parsed struct with the submitted data.

Comprehensive Action Support: The dispatcher correctly unmarshals all standard Slack input element types, including text inputs, select menus, date pickers, checkboxes, and more.

Context-Aware Handlers: All generated handlers include context.Context and the full slack.InteractionCallback payload, giving you complete access to the interaction's metadata.

Validation: Enforces the presence of callback_id on modals and action_id on input elements, failing fast on invalid JSON definitions.

Template-Driven: Uses Go's text/template package, allowing for easy customization of the generated code.

Project Structure
The generator expects the following file structure. The generated_structs directory is created automatically.

.
├── main.go                 # Main application entry point
├── parser.go               # Structs for parsing Slack JSON
├── generator.go            # Logic for generating individual modal structs
├── dispatcher_generator.go # Logic for generating the dispatcher
├── template.tmpl           # Template for the modal structs
├── dispatcher.tmpl         # Template for the dispatcher
├── my_modal_1.json         # Your input JSON definition
├── my_modal_2.json         # Your input JSON definition
└── generated_structs/      # Output directory for generated code
    ├── my_modal_1.go
    ├── my_modal_2.go
    └── dispatcher.go

How to Use
Step 1: Define Your Slack Modal JSON
Create one or more JSON files that define your Slack modals. The generator uses callback_id to name the handlers and action_id for the struct fields.

Example: user_feedback_modal.json

{
  "type": "modal",
  "callback_id": "user_feedback_modal",
  "title": {
    "type": "plain_text",
    "text": "Feedback"
  },
  "submit": {
    "type": "plain_text",
    "text": "Submit"
  },
  "blocks": [
    {
      "type": "input",
      "block_id": "rating_block",
      "element": {
        "type": "static_select",
        "action_id": "rating",
        "options": [
          { "text": { "type": "plain_text", "text": "5 - Excellent" }, "value": "5" },
          { "text": { "type": "plain_text", "text": "4 - Good" }, "value": "4" },
          { "text": { "type": "plain_text", "text": "3 - Average" }, "value": "3" }
        ]
      },
      "label": {
        "type": "plain_text",
        "text": "Overall Rating"
      }
    },
    {
      "type": "input",
      "block_id": "comments_block",
      "element": {
        "type": "plain_text_input",
        "action_id": "comments",
        "multiline": true
      },
      "label": {
        "type": "plain_text",
        "text": "Additional Comments"
      }
    },
    {
      "type": "actions",
      "block_id": "actions_block",
      "elements": [
        {
          "type": "button",
          "action_id": "share_anonymously_button",
          "text": {
            "type": "plain_text",
            "text": "Share Anonymously"
          },
          "value": "share_anonymously"
        }
      ]
    }
  ]
}

Step 2: Run the Code Generator
Execute the program from your terminal, passing the paths to your JSON files as arguments.

go run . user_feedback_modal.json

Step 3: Review the Generated Code
The generator will create files inside the generated_structs/ directory.

generated_structs/user_feedback_modal.go:

// Code generated by slack-modal-codegen. DO NOT EDIT.

package generated

// UserFeedbackModalInput represents the input fields from the "UserFeedbackModal" modal.
type UserFeedbackModalInput struct {
	Rating   string `json:"rating"`
	Comments string `json:"comments"`
}

generated_structs/dispatcher.go:
This file will contain the Dispatcher, handler interfaces, and registration methods for all processed modals.

Step 4: Implement the Handlers
In your main application logic, implement the generated handler interfaces and register them with the dispatcher.

package main

import (
    "context"
    "fmt"
    "log"

    "github.com/slack-go/slack"
    "path/to/your/project/generated_structs" // Import the generated package
)

// Implement the view submission handler
type FeedbackHandler struct{}

func (h *FeedbackHandler) Handle(ctx context.Context, interaction slack.InteractionCallback, input generated.UserFeedbackModalInput) error {
    fmt.Printf("Received feedback! User: %s, Rating: %s, Comments: %s\n",
        interaction.User.Name,
        input.Rating,
        input.Comments,
    )
    // Add your business logic here...
    return nil
}

// Implement the block action handler
type ShareButtonHandler struct{}

func (h *ShareButtonHandler) Handle(ctx context.Context, interaction slack.InteractionCallback, action slack.BlockAction) error {
    fmt.Printf("User %s clicked the '%s' button with value: %s\n",
        interaction.User.Name,
        action.ActionID,
        action.Value,
    )
    // Add logic to handle the button click...
    return nil
}


func main() {
    // 1. Create a new dispatcher
    dispatcher := generated.NewDispatcher()

    // 2. Register your handlers
    dispatcher.RegisterUserFeedbackModalHandler(&FeedbackHandler{})
    dispatcher.RegisterBlockActionHandler("share_anonymously_button", &ShareButtonHandler{})

    // 3. In your HTTP handler where you receive Slack interactions...
    // http.HandleFunc("/slack/interactions", func(w http.ResponseWriter, r *http.Request) {
    //     var interaction slack.InteractionCallback
    //     // ... (verify and parse the request body into `interaction`) ...
    //
    //     // 4. Dispatch the interaction
    //     err := dispatcher.Dispatch(r.Context(), interaction)
    //     if err != nil {
    //         log.Printf("Failed to dispatch interaction: %v", err)
    //         // Handle error appropriately
    //     }
    // })

    // ... (start your web server) ...
}
